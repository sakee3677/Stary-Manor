# Stary-Manor / è¿·é€”èŠåœ’
![menu](https://github.com/user-attachments/assets/328fb70a-e99e-42b5-b236-34b3bd61fc09)

> ä¸€æ¬¾åŸºæ–¼ Unity çš„ Isometric (ç­‰è·è¦–è§’) 2Dåƒç´ ç‰©ç†è§£è¬éŠæˆ²
> **æ ¸å¿ƒæ©Ÿåˆ¶ï¼š** éˆé­‚é™„èº«ç³»çµ± / ç‰©ç†äº’å‹•è§£è¬
    ä¸»è§’æœ¬èº«ä¸å…·æœ‰ç‰©ç†é‡é‡ç„¡æ³•æ¨å‹•ç‰©å“ï¼Œéœ€è¦é™„èº«ä¸åŒç”Ÿç‰©ä¾†è§£è¬

---

###  æ•…äº‹èƒŒæ™¯ (Story)
ä¸»è§’æ˜¯ä¸€ä½ç§å®¶åµæ¢ï¼Œå—è¨—é€²å…¥ä¸€åº§ç¥ç§˜èŠåœ’é€²è¡Œèª¿æŸ¥ï¼Œå»åœ¨é€”ä¸­é­åˆ°ä¸æ˜è¥²æ“Šã€‚
ç•¶ä¸»è§’å†æ¬¡é†’ä¾†æ™‚ï¼Œç™¼ç¾è‡ªå·±çš„èº«é«”ç™¼ç”Ÿäº†ç•°è®Šâ€”â€”**è®Šæˆäº†å¯æ„›çš„ç²‰ç´…å¹½éˆ**ã€‚
é›–ç„¶å¤±å»äº†è‚‰é«”ï¼Œä½†ä¹Ÿæ„å¤–ç²å¾—äº†**é™„èº«(Parasite)**çš„èƒ½åŠ›ã€‚ç©å®¶å¿…é ˆåˆ©ç”¨é€™å€‹èƒ½åŠ›ï¼Œæ“æ§èŠåœ’å…§çš„ç”Ÿç‰©ï¼Œè§£é–‹æ©Ÿé—œæ¨å‹•åŠ‡æƒ…æŸ¥å‡ºçœŸç›¸ã€‚


###  å±•ç¤º (Showcase)

|  é™„èº«æ©Ÿåˆ¶ (Parasite) | 
|  ![Parasite](https://github.com/user-attachments/assets/394d0ab3-14a1-401b-a190-30091fc4712a) | 
 *æè¿°ï¼šé™„èº«åˆ°å²èŠå§†èº«ä¸Š* 
 
|  å°è©±ç³»çµ± (DialogueManager) | 
| ![conversation](https://github.com/user-attachments/assets/0b970f46-6802-4a6f-bda7-6f8b6cdc7b7a) |
 *æè¿°ï¼šé…åˆåŠ‡æƒ…çš„å°è©±ç³»çµ±* 

---

###  æŠ€è¡“å¯¦ä½œ (Technical Details)

é€™æ˜¯æˆ‘ç”¨ä¾†ç·´ç¿’ Unity ç©æ³•æ¶æ§‹çš„å°ˆæ¡ˆï¼Œä¸»è¦æŠ€è¡“äº®é»å¦‚ä¸‹ï¼š

#### æ ¸å¿ƒè§’è‰²æ§åˆ¶å™¨ (Player Controller Implementation)
è…³æœ¬ï¼š`PlayerController.cs`
è² è²¬è™•ç†ä¸»è§’çš„ç§»å‹•ã€ç‰©ç†åˆ¤å®šä»¥åŠé™„èº«æ©Ÿåˆ¶çš„ç‹€æ…‹åˆ‡æ›ã€‚

* **Isometric è¼¸å…¥è½‰æ› (Coordinate Conversion):**
    * å°‡ç©å®¶çš„äºŒç¶­è¼¸å…¥å‘é‡ (Vector2 Input) è½‰æ›ç‚º Isometric 45åº¦è¦–è§’çš„ç§»å‹•é‚è¼¯ã€‚
    * å¯¦ä½œäº† 4 æ–¹å‘é–å®š (4-way locking)ï¼Œç¢ºä¿è§’è‰²åœ¨ç­‰è·è¦–è§’ä¸‹çš„ç§»å‹•ç¬¦åˆè¦–è¦ºé æœŸï¼Œé¿å…æ–œå‘æ»‘å‹•çš„é•å’Œæ„Ÿã€‚

* **é™„èº«ç‹€æ…‹æ©Ÿ (Possession State Machine):**
    * ä½¿ç”¨ `Enum` å®šç¾©é™„èº«éšæ®µ (`Prepare` -> `Parasiting` -> `None`)ã€‚ 
    * **å¹³æ»‘éæ¸¡ (Smooth Transition):** åœ¨ `Prepare` éšæ®µä½¿ç”¨ `Vector3.MoveTowards` å¯¦ç¾éˆé­‚è¢«å¸å…¥ç‰©é«”çš„å¹³æ»‘ä½ç§»ï¼Œä¸¦åœ¨æ¥è§¸ç¬é–“åˆ‡æ›ç‰©ç†ç¢°æ’å±¤ (Collision Layer)ã€‚

* **ä»‹é¢å°å‘è¨­è¨ˆ (Interface Oriented):**
    * é€é `IUsable` èˆ‡ `IControllable` ä»‹é¢èˆ‡å ´æ™¯ç‰©ä»¶äº’å‹•ï¼Œé™ä½è§’è‰²èˆ‡å…·é«”ç‰©å“é‚è¼¯çš„è€¦åˆåº¦ (Coupling)ã€‚


 ####  æ•˜äº‹èˆ‡äº‹ä»¶ç³»çµ± (Narrative & Event Integration)
è…³æœ¬ï¼š`DialogueManager.cs`
ä¸€å€‹æ–‡å­—é¡¯ç¤ºç³»çµ±ï¼Œæ˜¯æ¨å‹•éŠæˆ²åŠ‡æƒ…çš„ **äº‹ä»¶é©…å‹•å™¨ (Event Driver)**ã€‚

* **ä½‡åˆ—ç®¡ç† (Queue-based Handling):**
    ä½¿ç”¨ `Queue<DialogueLine>` è³‡æ–™çµæ§‹ä¾†ç®¡ç†å°è©±æµï¼Œç¢ºä¿å…ˆé€²å…ˆå‡º (FIFO) çš„é‚è¼¯é †åºã€‚
* **äº‹ä»¶åŒæ­¥æ©Ÿåˆ¶ (Async Event Synchronization):**
    * è§£æ±ºäº†ã€Œå°è©±ã€èˆ‡ã€Œæ¼”å‡ºã€ä¸åŒæ­¥çš„å•é¡Œã€‚é€é **Coroutines** å¯¦ä½œäº†ä¸€å€‹ç­‰å¾…æ©Ÿåˆ¶ã€‚
    * ç•¶å°è©±è§¸ç™¼ç‰¹æ®Šäº‹ä»¶ï¼ˆå¦‚ï¼šæ’­æ”¾ä¸€æ®µå‹•ç•«æˆ–é–‹å•Ÿæ©Ÿé—œï¼‰æ™‚ï¼Œç³»çµ±æœƒé–å®šè¼¸å…¥ï¼Œç›´åˆ°æ”¶åˆ° `RegisterEventCallback()` å›å‚³è¨Šè™Ÿï¼Œæ‰å…è¨±ç©å®¶ç¹¼çºŒé–±è®€ã€‚
* **é«˜åº¦æ•´åˆ UnityEvent:**
    * åˆ©ç”¨ Unity å…§å»ºçš„ `UnityEvent` ç³»çµ±ï¼Œè®“è¨­è¨ˆå¸«å¯ä»¥åœ¨ Inspector é¢æ¿ä¸­ç›´æ¥æ‹–æ›³ä¸¦ç¶å®šå°è©±çµæŸå¾Œè¦è§¸ç™¼çš„é‚è¼¯ï¼ˆä¾‹å¦‚ï¼š`CameraShake`, `PlaySound`, `LoadScene`ï¼‰ï¼Œç„¡éœ€ç¡¬ç·¨ç¢¼ (Hard-coding)ã€‚

> ğŸ”— **æ ¸å¿ƒé‚è¼¯å±•ç¤ºï¼š**
> ```csharp
> // ä½¿ç”¨ Coroutine ç­‰å¾…å¤–éƒ¨äº‹ä»¶å®Œæˆ
> IEnumerator WaitForEventAndEnableInput(DialogueLine line)
> {
>     // é–å®šç©å®¶è¼¸å…¥
>     isWaitingForInput = false; 
>     
>     // è§¸ç™¼ç¶å®šåœ¨å°è©±ä¸Šçš„äº‹ä»¶ (å¦‚ï¼šæ’­æ”¾å‹•ç•«)
>     line.onDialogueEvent.Invoke(); 
>
>     // æš«åœç¨‹å¼ç¢¼åŸ·è¡Œï¼Œç›´åˆ°æ”¶åˆ°æ‰€æœ‰äº‹ä»¶çš„å›èª¿è¨Šè™Ÿ (Callback)
>     yield return new WaitUntil(() => eventCompleted);
>     
>     // äº‹ä»¶å®Œæˆï¼Œè§£é–è¼¸å…¥
>     isWaitingForInput = true;
> }
> ```


> ğŸ”— **ç¨‹å¼ç¢¼é–±è¦½ (Code Highlight)ï¼š**
> * [PlayerController.cs](./Assets/Scripts/ç©å®¶/PlayerController.cs) - è™•ç†è§’è‰²ç§»å‹•èˆ‡é™„èº«ç‹€æ…‹åˆ‡æ›
> * [DialogueManager.cs](./Assets/Scripts/åŠ‡æƒ…å°è©±ç›¸é—œ/DialogueManager.cs) - å°è©±ç³»çµ±


---

### ğŸš€ å¦‚ä½•è©¦ç© (How to Play)
1.  å¾é€™è£¡ä¸‹è¼‰ Demo ç‰ˆæœ¬ï¼š[https://drive.google.com/file/d/1JJZtUfFZqolUgjR0xRYO-xX5_ILfSLKd/view?usp=sharing]
2.  è§£å£“ç¸®å¾ŒåŸ·è¡ŒéŠæˆ²ã€‚
3.  **æ“ä½œèªªæ˜ï¼š**
    * **WASD**: ç§»å‹•
    * **Space**: è·³èº/ç©ºä¸­æŒ‰ä½æ¼‚æµ®
    * **j éµ**: åœ¨ç‰©é«”ä¸Šæ–¹ï¼Œé€²è¡Œé™„èº« / è§£é™¤é™„èº«
    * **e å»º**: ç¹¼çºŒå°è©±

---

### ğŸ“ æœªä¾†å„ªåŒ–æ–¹å‘ (Roadmap)
* [ ] æ–°å¢é™„èº«ç”Ÿç‰©çš„npcé‚è¼¯(å¦‚:å·¡é‚ã€æ”»æ“Šç©å®¶ç­‰)ã€‚
* [ ] æ–°å¢æ›´å¤šé—œå¡ä»¥åŠå„ªåŒ–é—œå¡æµç¨‹
